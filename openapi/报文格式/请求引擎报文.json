{
  "flow_id": "d2b5d96499c1476db9893b028b593eb6",
  "notify_url": null,
  "parties": null,
  "schedule_policy": null,
  "jobs": [
    {
      "job_id": "op-psi-v3-2d7492e5af8e476484a0609a9ea760",
      "dependencies": [
        "fl-customized-merge-data-8db96364f9e347b"
      ],
      "parties": [
        {
          "domain_id": "alice-becb78736f69468389f4059ee57a19b9",
          "role": null,
          "version": null
        },
        {
          "domain_id": "bob-f0d56d76b5af4f9abd61029adff7c60a",
          "role": null,
          "version": null
        }
      ],
      "op_type": "OP_PSI_V3",
      "op_body": "{\"psi_protocol\":\"ecdh\",\"should_sort\":true,\"num_bins\":64,\"parties\":{\"alice-becb78736f69468389f4059ee57a19b9\":{\"id_fields\":[\"id1\"],\"output_path\":\"dmdt://alice-becb78736f69468389f4059ee57a19b9:29c055297d3a4faa91ba89493d61acab/psi1687683146321_yutu_123_20230705171652_241@data/xy3y7vck/psi/20230704/psi1687683146321_yutu_123_20230705171652_241\",\"input_path\":\"dmdt://alice-becb78736f69468389f4059ee57a19b9:29c055297d3a4faa91ba89493d61acab/xy3y7vck_node_1_output_1_20230705171652_306\"},\"bob-f0d56d76b5af4f9abd61029adff7c60a\":{\"id_fields\":[\"id2\"],\"output_path\":\"dmdt://bob-f0d56d76b5af4f9abd61029adff7c60a:07b4e34dc63a4fc78546dcfe275fc0c5/psi1687683146321_yutu_123_20230705171652_241@data/xy3y7vck/psi/20230704/psi1687683146321_yutu_123_20230705171652_241\",\"input_path\":\"dmdt://bob-f0d56d76b5af4f9abd61029adff7c60a:39b0210fb8794cfabec2f3c9ba428669/9eb2c8f27d984c2d9bfed6424dfa3b3e@20230510\"}}}",
      "app": "mpc_trainer",
      "central_domain": null,
      "component": "{\"virtual\":false,\"dependencyReplica\":[\"xy3y7vck_node_1\",\"xy3y7vck_node_2\"],\"component_id\":\"xy3y7vck_node_3\",\"job_id\":null,\"code_name\":\"OPERATOR_PRIVACY_INTERSECTION\",\"name\":\"隐私求交\",\"namespace\":\"Ant\",\"op\":\"OP_PSI_V3\",\"dependencies\":[\"xy3y7vck_node_1\",\"xy3y7vck_node_2\"],\"params\":{\"input_slots\":[{\"related_id\":\"xy3y7vck_node_1_output_1\",\"table_id\":null,\"sequence\":1,\"name\":null,\"type\":null,\"parties\":null},{\"related_id\":\"xy3y7vck_node_2_output_1\",\"table_id\":null,\"sequence\":2,\"name\":null,\"type\":null,\"parties\":null}],\"output_slots\":[{\"id\":\"xy3y7vck_node_3_output_1\",\"name\":\"psi1687683146321_yutu_123\",\"type\":\"virtualtable\",\"ref_id\":null,\"ext_info\":null}],\"parties\":{\"alice-becb78736f69468389f4059ee57a19b9\":{\"id_fields\":[\"id1\"]},\"bob-f0d56d76b5af4f9abd61029adff7c60a\":{\"id_fields\":[\"id2\"]}},\"hyper_params\":{\"psi_protocol\":\"ecdh\",\"num_bins\":64,\"should_sort\":true,\"parties\":{\"alice-becb78736f69468389f4059ee57a19b9\":{\"ds_id\":\"alice-becb78736f69468389f4059ee57a19b9:29c055297d3a4faa91ba89493d61acab\",\"path\":\"\",\"partition_by\":\"${yyyymmdd}-0\",\"time_zone\":\"GMT+08:00\"},\"bob-f0d56d76b5af4f9abd61029adff7c60a\":{\"ds_id\":\"bob-f0d56d76b5af4f9abd61029adff7c60a:07b4e34dc63a4fc78546dcfe275fc0c5\",\"path\":\"\",\"partition_by\":\"${yyyymmdd}-0\",\"time_zone\":\"GMT+08:00\"}}},\"extra_params\":{}},\"extra\":\"{\\\"x\\\":220,\\\"y\\\":190,\\\"showPorts\\\":true,\\\"join_type\\\":\\\"inner_join\\\",\\\"output_name\\\":\\\"psi1687683146321_yutu_123\\\",\\\"featureNames\\\":\\\"id1,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,y,id2,x11,x12,x13,x14,x15,x16,x17,x18,x19,x20\\\",\\\"parties\\\":{\\\"alice-becb78736f69468389f4059ee57a19b9\\\":{\\\"feature_names\\\":[\\\"x1\\\",\\\"x2\\\",\\\"x3\\\",\\\"x4\\\",\\\"x5\\\",\\\"x6\\\",\\\"x7\\\",\\\"x8\\\",\\\"x9\\\",\\\"x10\\\",\\\"y\\\"]},\\\"bob-f0d56d76b5af4f9abd61029adff7c60a\\\":{\\\"feature_names\\\":[\\\"x11\\\",\\\"x12\\\",\\\"x13\\\",\\\"x14\\\",\\\"x15\\\",\\\"x16\\\",\\\"x17\\\",\\\"x18\\\",\\\"x19\\\",\\\"x20\\\"]}},\\\"selectFeatures\\\":\\\"x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,y,x11,x12,x13,x14,x15,x16,x17,x18,x19,x20\\\",\\\"id_fields\\\":{\\\"24948a613c8f46a389237ff9ad3bf787\\\":[{\\\"associatedKey0\\\":\\\"id1（1）\\\"}],\\\"9eb2c8f27d984c2d9bfed6424dfa3b3e\\\":[{\\\"associatedKey0\\\":\\\"id2\\\"}]},\\\"sampleTables\\\":[{\\\"nodeId\\\":\\\"alice-becb78736f69468389f4059ee57a19b9\\\",\\\"tableName\\\":\\\"linear_a_1117\\\",\\\"schemas\\\":\\\"id1,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,y\\\",\\\"groupKeys\\\":\\\"x1,x2,y\\\",\\\"schemaTypes\\\":\\\"string,double,double,double,double,double,double,double,double,double,double,double\\\",\\\"associatedKeys\\\":\\\"id1,x3\\\",\\\"sampleTable\\\":\\\"24948a613c8f46a389237ff9ad3bf787\\\"},{\\\"nodeId\\\":\\\"bob-f0d56d76b5af4f9abd61029adff7c60a\\\",\\\"tableName\\\":\\\"linear_b_1117\\\",\\\"schemas\\\":\\\"id2,x11,x12,x13,x14,x15,x16,x17,x18,x19,x20\\\",\\\"groupKeys\\\":\\\"\\\",\\\"schemaTypes\\\":\\\"string,double,double,double,double,double,double,double,double,double,double\\\",\\\"associatedKeys\\\":\\\"id2,x13\\\",\\\"sampleTable\\\":\\\"9eb2c8f27d984c2d9bfed6424dfa3b3e\\\"}],\\\"result_address\\\":[{\\\"ds_id\\\":\\\"alice-becb78736f69468389f4059ee57a19b9:29c055297d3a4faa91ba89493d61acab\\\",\\\"disabledPath\\\":\\\"dev/alice/gjyxdata\\\",\\\"node_id\\\":\\\"alice-becb78736f69468389f4059ee57a19b9\\\",\\\"date\\\":\\\"${yyyymmdd}\\\",\\\"operator\\\":\\\"-\\\",\\\"partition_by\\\":0},{\\\"ds_id\\\":\\\"bob-f0d56d76b5af4f9abd61029adff7c60a:07b4e34dc63a4fc78546dcfe275fc0c5\\\",\\\"disabledPath\\\":\\\"dev/bob/gjyxdata\\\",\\\"node_id\\\":\\\"bob-f0d56d76b5af4f9abd61029adff7c60a\\\",\\\"date\\\":\\\"${yyyymmdd}\\\",\\\"operator\\\":\\\"-\\\",\\\"partition_by\\\":0}]}\",\"status\":0,\"is_periodic\":true}"
    },
    {
      "job_id": "fl-customized-merge-data-8db96364f9e347b",
      "dependencies": [],
      "parties": [
        {
          "domain_id": "flserver-aed22af858644319a324e24476111c14",
          "role": "server",
          "version": null
        },
        {
          "domain_id": "alice-becb78736f69468389f4059ee57a19b9",
          "role": "client",
          "version": null
        }
      ],
      "op_type": "FL_CUSTOMIZED_MERGE_DATA",
      "op_body": "{\"codes\":[\"# 请根据输入输出配置填写对应的ARGS.变量名\\nfrom typing import List\\nfrom fascia.api.feddata import FedData\\nfrom fascia.args import ARGS\\nimport secretflow as sf\\nfrom secretflow.data.io.util import open as sfopen\\nfrom secretflow.data.io.util import Path\\n\\ndef merge_data():\\n    fed_data_list =  []\\n    fedData = FedData([ARGS.input0])\\n    fed_data_list.append(fedData)\\n    fedData = FedData([ARGS.input1])\\n    fed_data_list.append(fedData)\\n    output_fed_data = FedData(ARGS.output0, is_csv=True, fed_type='vertical')\\n\\n    local_paths = {}\\n    for fed_data in fed_data_list:\\n        for device, path in fed_data.file_local_path.items():\\n            if device not in local_paths:\\n                local_paths[device] = []\\n            local_paths[device].append(path)\\n\\n    # 合并数据\\n    def merge(source_files: List[str], output_path: str):\\n        Path(output_path).parent.mkdir(parents=True, exist_ok=True)\\n        out_file = sfopen(output_path, \\\"w\\\")\\n        with_header = True\\n        header = None\\n        for source_file in source_files:\\n            with sfopen(source_file, 'r') as in_file:\\n                for lineno, line in enumerate(in_file):\\n                    if lineno == 0 and with_header:\\n                        with_header = False\\n                        header = line\\n                    elif lineno == 0:\\n                        assert header == line, f\\\"file has different header: '{header}' != '{line}'\\\"\\n                        continue\\n                    if len(line) == 0:\\n                        continue\\n                    out_file.write(line)\\n                    if not line.endswith(\\\"\\\\n\\\"):\\n                        out_file.write(\\\"\\\\n\\\")\\n\\n        out_file.close()\\n\\n    output_local_path = output_fed_data.file_local_path\\n\\n    res = []\\n    for device, paths in local_paths.items():\\n        res.append(device(merge)(paths, output_local_path[device]))\\n\\n    sf.wait(res)\\n\\n    # 推送数据到远端\\n    output_fed_data.dtypes = fed_data_list[0].dtypes\\n    output_fed_data.save()\\n\\nmerge_data()\"],\"data_placeholders\":{\"input0\":{\"party_id\":\"alice-becb78736f69468389f4059ee57a19b9\",\"schema\":{\"field_delimiter\":\",\",\"fields\":[{\"is_key\":false,\"name\":\"id1\",\"type\":\"DATA_TYPE_STRING\"},{\"is_key\":false,\"name\":\"x1\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x2\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x3\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x4\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x5\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x6\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x7\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x8\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x9\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x10\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"y\",\"type\":\"DATA_TYPE_FLOAT\"}]},\"uri\":\"dmdt://24948a613c8f46a389237ff9ad3bf787@20230509\"},\"input1\":{\"party_id\":\"alice-becb78736f69468389f4059ee57a19b9\",\"schema\":{\"field_delimiter\":\",\",\"fields\":[{\"is_key\":false,\"name\":\"id1\",\"type\":\"DATA_TYPE_STRING\"},{\"is_key\":false,\"name\":\"x1\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x2\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x3\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x4\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x5\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x6\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x7\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x8\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x9\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"x10\",\"type\":\"DATA_TYPE_FLOAT\"},{\"is_key\":false,\"name\":\"y\",\"type\":\"DATA_TYPE_FLOAT\"}]},\"uri\":\"dmdt://24948a613c8f46a389237ff9ad3bf787@20230510\"}},\"extra_placeholders\":{},\"table_placeholders\":{\"output0\":{\"data\":[{\"extras\":{\"mapping_name_prefix\":\"data/xy3y7vck/read_table/node_1_output_1_20230705171652_306\"},\"party_id\":\"alice-becb78736f69468389f4059ee57a19b9\",\"uri\":\"dmds://alice-becb78736f69468389f4059ee57a19b9:29c055297d3a4faa91ba89493d61acab\"}],\"uid\":\"xy3y7vck_node_1_output_1_20230705171652_306\"}}}",
      "app": "fascia",
      "central_domain": null,
      "component": "{\"virtual\":false,\"dependencyReplica\":null,\"component_id\":\"xy3y7vck_node_1\",\"job_id\":null,\"code_name\":\"OPERATOR_READ_SAMPLE_TABLE\",\"name\":\"读样本表\",\"namespace\":\"Ant\",\"op\":\"OP_MULTI_READ_DATA\",\"dependencies\":null,\"params\":{\"input_slots\":[],\"output_slots\":[{\"id\":\"xy3y7vck_node_1_output_1\",\"name\":\"\",\"type\":\"datatable\",\"ref_id\":null,\"ext_info\":null}],\"parties\":{\"alice-becb78736f69468389f4059ee57a19b9\":{\"time_zone\":\"GMT+08:00\",\"partition_by\":\"(20230508,20230511)\"}},\"hyper_params\":{\"table_id\":\"24948a613c8f46a389237ff9ad3bf787\",\"partition_by\":{\"left\":\"20230508\",\"right\":\"20230511\"},\"bizdate_type\":\"custom\",\"nodeId\":\"alice-becb78736f69468389f4059ee57a19b9\",\"schemas\":\"\",\"schemaTypes\":\"\",\"associatedKeys\":\"\",\"is_partition\":true,\"rule_type\":\"${yyyymmdd}\",\"custom_type\":\"between\",\"op_type\":\"OP_READ_DATA\",\"left_equal\":\"(\",\"left\":\"20230508\",\"right\":\"20230511\",\"right_equal\":\")\",\"parties\":{\"alice-becb78736f69468389f4059ee57a19b9\":{\"time_zone\":\"GMT+08:00\",\"partition_by\":\"(20230508,20230511)\"}}},\"extra_params\":{}},\"extra\":\"{\\\"x\\\":105,\\\"y\\\":53,\\\"featureNames\\\":\\\"\\\",\\\"op_type\\\":\\\"OP_MULTI_READ_DATA\\\"}\",\"status\":0,\"is_periodic\":true}"
    },
    {
      "job_id": "op-table-statistics-49e07bcfb657446d8f79",
      "dependencies": [
        "op-psi-v3-2d7492e5af8e476484a0609a9ea760"
      ],
      "parties": [
        {
          "domain_id": "alice-becb78736f69468389f4059ee57a19b9",
          "role": null,
          "version": null
        },
        {
          "domain_id": "bob-f0d56d76b5af4f9abd61029adff7c60a",
          "role": null,
          "version": null
        }
      ],
      "op_type": "OP_TABLE_STATISTICS",
      "op_body": "{\"parties\":{\"alice-becb78736f69468389f4059ee57a19b9\":{\"fields\":[{\"name\":\"x1\",\"type\":\"double\"},{\"name\":\"x2\",\"type\":\"double\"},{\"name\":\"x3\",\"type\":\"double\"},{\"name\":\"x4\",\"type\":\"double\"},{\"name\":\"x5\",\"type\":\"double\"},{\"name\":\"x6\",\"type\":\"double\"},{\"name\":\"x7\",\"type\":\"double\"},{\"name\":\"x8\",\"type\":\"double\"},{\"name\":\"x9\",\"type\":\"double\"},{\"name\":\"x10\",\"type\":\"double\"},{\"name\":\"y\",\"type\":\"double\"}],\"in_path\":\"dmdt://alice-becb78736f69468389f4059ee57a19b9:29c055297d3a4faa91ba89493d61acab/psi1687683146321_yutu_123_20230705171652_241\"},\"bob-f0d56d76b5af4f9abd61029adff7c60a\":{\"fields\":[{\"name\":\"x11\",\"type\":\"double\"},{\"name\":\"x12\",\"type\":\"double\"},{\"name\":\"x13\",\"type\":\"double\"},{\"name\":\"x14\",\"type\":\"double\"},{\"name\":\"x15\",\"type\":\"double\"},{\"name\":\"x16\",\"type\":\"double\"},{\"name\":\"x17\",\"type\":\"double\"},{\"name\":\"x18\",\"type\":\"double\"},{\"name\":\"x19\",\"type\":\"double\"},{\"name\":\"x20\",\"type\":\"double\"}],\"in_path\":\"dmdt://bob-f0d56d76b5af4f9abd61029adff7c60a:07b4e34dc63a4fc78546dcfe275fc0c5/psi1687683146321_yutu_123_20230705171652_241\"}}}",
      "app": "mpc_trainer",
      "central_domain": null,
      "component": "{\"virtual\":false,\"dependencyReplica\":[\"xy3y7vck_node_3\"],\"component_id\":\"xy3y7vck_node_4\",\"job_id\":null,\"code_name\":\"OPERATOR_TABLE_STATISTIC\",\"name\":\"全表统计\",\"namespace\":\"Ant\",\"op\":\"OP_TABLE_STATISTICS\",\"dependencies\":[\"xy3y7vck_node_3\"],\"params\":{\"input_slots\":[{\"related_id\":\"xy3y7vck_node_3_output_1\",\"table_id\":null,\"sequence\":1,\"name\":null,\"type\":null,\"parties\":null}],\"output_slots\":[{\"id\":\"xy3y7vck_node_4_output_1\",\"name\":\"\",\"type\":\"report\",\"ref_id\":null,\"ext_info\":null}],\"parties\":{\"alice-becb78736f69468389f4059ee57a19b9\":{\"fields\":[{\"name\":\"x1\",\"type\":\"double\"},{\"name\":\"x2\",\"type\":\"double\"},{\"name\":\"x3\",\"type\":\"double\"},{\"name\":\"x4\",\"type\":\"double\"},{\"name\":\"x5\",\"type\":\"double\"},{\"name\":\"x6\",\"type\":\"double\"},{\"name\":\"x7\",\"type\":\"double\"},{\"name\":\"x8\",\"type\":\"double\"},{\"name\":\"x9\",\"type\":\"double\"},{\"name\":\"x10\",\"type\":\"double\"},{\"name\":\"y\",\"type\":\"double\"}]},\"bob-f0d56d76b5af4f9abd61029adff7c60a\":{\"fields\":[{\"name\":\"x11\",\"type\":\"double\"},{\"name\":\"x12\",\"type\":\"double\"},{\"name\":\"x13\",\"type\":\"double\"},{\"name\":\"x14\",\"type\":\"double\"},{\"name\":\"x15\",\"type\":\"double\"},{\"name\":\"x16\",\"type\":\"double\"},{\"name\":\"x17\",\"type\":\"double\"},{\"name\":\"x18\",\"type\":\"double\"},{\"name\":\"x19\",\"type\":\"double\"},{\"name\":\"x20\",\"type\":\"double\"}]}},\"hyper_params\":{},\"extra_params\":{}},\"extra\":\"{\\\"x\\\":217.5,\\\"y\\\":335,\\\"union_type\\\":\\\"axis1\\\",\\\"featureNames\\\":\\\"x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,y,x11,x12,x13,x14,x15,x16,x17,x18,x19,x20\\\"}\",\"status\":0,\"is_periodic\":true}"
    }
  ],
  "generateId": null
}